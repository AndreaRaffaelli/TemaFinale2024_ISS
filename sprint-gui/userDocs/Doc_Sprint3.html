<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<head>
	<!--
<link rel="stylesheet" type="text/css" href="../css/issStyle1.css">
<script type="text/javascript" src="../css/issStyle.js"></script>
-->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/foundation-sites@6.7.4/dist/css/foundation.min.css"
		crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/foundation-sites@6.7.4/dist/js/foundation.min.js"
		crossorigin="anonymous"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="./commons/resources/styles/templateISS.css">
	<link rel="stylesheet" type="text/css" href="./commons/resources/styles/main.css">
	<link rel="stylesheet" type="text/css" href="./commons/resources/styles/navbar.css">
	<link rel="stylesheet" type="text/css" href="./commons/resources/styles/table.css">
	<link rel="stylesheet" type="text/css" href="./commons/resources/styles/code.css">
	<!-- <script type="text/javascript" src="./commons/resources/scripts/myScripts.js"></script> -->
	<style type="text/css">
		body {
			margin-left: 30px;
			margin-right: 30px;
			font-size: 18px;
		}

		;

		P {
			font-family: Tahoma;
			font-size: 10pt;
		}

		;

		a,
		a:visited,
		a:active,
		a:link,
		a:hover {
			text-decoration: underline;
			color: #545454;
			background-color: transparent;
			font-size: 93%;
		}

		a:hover {
			background-color: #cccccc;
		}


		hr {
			clear: both;
			height: 1px;
			color: #242424;
			background-color: transparent;
		}

		h1,
		h2,
		h3 {
			color: #242424;
			clear: left;
			font: 100% Tahoma, Helvetica, Arial, sans-serif;
			margin-bottom: 0.5em;
			padding-top: 0.5em;
			border-radius: 10px;
			padding: 5px;
		}

		top {
			width: 100%;
		}


		#i {
			color: #ff1010;
		}

		tt {
			font-family: "Arial";
			font-size: 90%;
			color: #006600;
		}

		em {
			font-family: "Arial";
			font-size: 80%;
			font-weight: bold;
			border-style: solid;
			border-color: #abe876;
			color: #1632cc;
		}

		bc {
			font-family: "Arial";
			font-size: 90%;
			font-weight: bold;
			color: #990000;
			background-color: #fcf8c7;
		}

		ks {
			font-family: "Arial";
			font-weight: bold;
			color: #0000CD;
			font-size: 90%;
		}

		kc {
			font-family: "Arial";
			font-weight: bold;
			color: #008000;
			font-size: 90%;
		}

		/* 		pre {
			font-family: "Consolas";
			font-size: 85%;
			background-color: #f5f5f5;
			border: 1.5px solid silver;
			padding: 5px;
		} */

		m {
			font-family: "Helvetica";
			line-height: 100%;
			font-size: 75%;
		}

		div.body {

			font-size: 18px;
		}

		k {
			color: #990000;
			font-weight: bold;
			font-size: 90%;
		}

		h1 {
			font-size: 150%;
			background-color: #b2c0ff;
			padding: 10px;
		}

		h2 {
			background-color: #9ed8ff;
			font-size: 130%;
		}

		h3 {
			background-color: #e6ccff;
			font-size: 100%;
		}

		h4 {
			background-color: #ccffcc;
			font-size: 100%;
			width: 95%;
			border-radius: 5px;
			padding: 2px;
		}

		h5 {
			background-color: #d5ffb0;
			font-size: 100%;

		}

		div.req {
			background-color: #d9ffb3;
			font-size: 18px;
			width: 700px;
			border: 3px solid green;
			padding: 15px;
			margin: 10px;
		}

		div.remark {
			background-color: #E3F2FD;
			border: 1.5px solid #d5f2ed;
			padding: 15px;
			margin: 10px;
			border-radius: 25px;
		}

		table,
		th,
		td {
			border: 1px solid black;
			border-collapse: collapse;
		}

		ol,
		ul,
		li {
			margin: 0;
			margin-left: 10px;
			padding: 0;
			padding-bottom: 5px;
		}

		table,
		th,
		td {
			border: 1px solid black;
		}

		img {
			border: 1.5px solid #d5f2ed
		}

		a,
		a:visited,
		a:active,
		a:link,
		a:hover {
			text-decoration: underline;
			color: #545454;
			background-color: transparent;
		}

		div.wrapdesc {
			width: 90%;
			margin: auto;
		}

		div.imagedesc {
			width: 85%;
			margin: auto;
		}

		pre code {
			background-color: #eee;
			display: block;
			text-align: left;
			font-size: 85%;
		}

		code {
			padding-left: 20px;
		}
	</style>



</head>






<title>Sprint 3</title>
</head>

<body>
	<div id="top">
		<h1>LABORATORIO DI INGEGNERIA DEI SISTEMI SOFTWARE <font size="5"></font>
		</h1>
	</div>
<!--



-->
	<div class="body">
		<h2>Introduction</h2>
		<a href="../../TemaFinale24.html">Richiesta del committente</a>
		<h2>
			Analisi dei Requisiti
		</h2>
		<a href="../../sprint0/userDocs/Doc_Sprint03.html">Requisiti</a><br>
		Architettura logica prodotta all'interno dello <a href="../../sprint2/userDocs/Doc_Sprint2.html">sprint2</a>:<br>
		<center>
			<img src="./img/archLogica2.png" alt="imgAL" width="49%" height="50%">
			<img src="./img/archLogica_1.2.png" alt="imgAL" width="49%" height="50%">
		</center>

		<h2> Goal Dello Sprint 3</h2>
		Affrontare l'analisi dei problemi introdotti dai requisiti R5, generare un'architettura logica, un modello
		eseguibile e dei test automatizzati.
		<br><br>

		<h2>Analisi dei requisiti</h2>

		<ul>
			<li>R5.1: Visualizzare lo stato del WasteStorage.</li>
			<li>R5.2: Visualizzare lo stato dell'AshStorage.</li>
			<li>R5.3: Visualizzare lo stato dell'inceneritore.</li>
			<li>R5.4: Visualizzare lo stato del OpRobot.</li>
		</ul>
		Dissertazione:

		Non è specificato in che modo la GUI debba ottenere queste informazioni dal sistema, e ci sono diverse alternative possibili:
		<ul>
			<li>La GUI potrebbe eseguire un polling periodico sui vari componenti per rilevare eventuali cambiamenti.  </li>
			<li>Potrebbe ricevere notifiche sui cambiamenti di stato da parte di un attore dedicato.  </li>
			<li>Oppure potrebbe ricevere direttamente dal sistema WIS le informazioni aggiornate.  </li>
		</ul>
		Attualmente, il sistema WIS dispone già di tutte le informazioni necessarie per aggiornare lo stato della GUI.


		Poiche' il linguaggio di modellazione non permette l'osservazione tra due nodi remoti, una possibilita' potrebbe essere
		l'inserimento di un nuovo attore <code style="padding:0;">opEventBridge</code> con il compito di osservare i cambi di stato del
		opRobot ed inviare informazioni a SSGUI. <br>
		Considerando il costo contenuto per una modifica all'attore <code style="padding:0;">WIS</code>,
		non si reputa vantaggiosa l'aggiunta di nuovo componente per questo fine, in quanto non è un requisito richiesto dal committente.
		Per questo quindi si valuta di effettuare il deploy della GUI nello stesso nodo della ServiceArea, modificando <code style="padding:0;">WIS</code>
		in modo tale da inviare informazioni alla dashboard riguardo i cambi di stato del opRobot.
		<br>
		Dai requisiti non si evince che la GUI sia una pagina web ma per semplicita' di sviluppo ed utilizzo si e' scelto l'impiego di un approccio
		simil Facade, utilizzando il framework SpringBoot.
		<br>



		<h2>Problematiche</h2>
		<ul>
			<li>Come avviene la comunicazione tra WIS e SSGUI?</li>
			<li>
				Dissertazione:
				<br>
				La comunicazione avviene tramite l’aggiornamento delle risorse relative alle seguenti variabili:
				<code style="padding: 0%;">Ws_status</code> e
				<code style="padding: 0%;">As_status</code> di WIS, e
				<code style="padding: 0%;">MentalState</code> e
				<code style="padding: 0%;">RobotState</code> di opRobot, osservate da WIS.
				<br>
				Queste variabili gestiscono lo stato dei componenti richiesti, ad eccezione dello stato dell’inceneritore, che sarà aggiornato separatamente attraverso
				la variabile <code style="padding: 0%;">MentalState</code>. Ricordiamo la differenze tra le variabili RobotState e MentalState: la prima
				rappresenta lo stato di occupazione (working/idle) e la seconda rappresenta l'attività che sta svolgendo.
				<br>
				Tutte queste informazioni sono monitorate e osservate da <code style="padding: 0%;">CoapObserver</code>.
			</li>
		</ul>


<!--

FacadeController: restituisce la GUI iniziale e crea il facadeBuilder
FacadeBuilder: crea tutti gli altri e basta
WSHandler: fa connessione client server attraverso web socket (get e post sono dirette a FacadeController)
		quando riceve un messaggio, inoltra a Applguicore (handleWsMsg) che, se e' un cmd, lo inoltra ad ActorOutIn che lo
		inviera' all'actor
CoapObserver: osserva gli actors e inoltra a ApplguiCore (handleMsgFromActor) che poi fa una ActorOutIn.sendtoall()
		quando coapobserver osserva quindi, wsHandler.sendToAll viene chiamato, sempre!
RobotUtils da utilizzare solo sendApplMsg(...) per inviare messaggi agli actors

-->



        <h2>Architettura Logica</h2>
        <center><img src="./img/Facade24StartCreation.PNG" alt="imgAL" width="50%" height="50%"></center>
        <h2>Progettazione</h2>
        <p>Poiché la bilancia sarà fornita dal committente, in questo sprint è stata emulata mediante un pulsante, il quale invia una richiesta per l'aggiunta di un RP al sistema WIS.<br>
        Quando il componente reale sarà disponibile, sarà possibile implementare un attore adapter per incapsularlo. Questo consentirà di gestire la bilancia come un componente attivo, in grado di inviare messaggi ogni volta che viene aggiunto un RP.</p>

		<h2>Deploy</h2>
		Come già anticipato in Problematiche, è necessario effettuare il deploy della GUI nello stesso nodo della Service Area, a causa della natura
		dei metodi di comunicazione fornite dal Qak.<br>
		Per semplificare il processo, abbiamo scelto di utilizzare Docker Swarm come orchestratore.
		Docker Swarm consente di creare una rete VPN tra due nodi e offre funzionalità di DNS integrate.
		Inoltre, grazie a questa scelta, possiamo adottare un approccio di deploy dichiarativo, che è dettagliato nel file
		<a href="../../docker-compose-swarm.yml">docker-compose-swarm.yml</a>.
		<br><br>
		<h3>Preconfigurazione</h3>
		<b>Configurazione del MANAGER</b>
		<pre>
			<code>
docker swarm init --advertise-addr "IP_MANAGER"

docker swarm join-token worker
			</code>
		</pre>

		Con il secondo comando verra' creato "TOKEN"<br><br>

		<b>Configurazione del Raspberry PI come nodo del sistema:</b>
		<pre>
			<code>
docker swarm join --token "TOKEN" "IP_MANAGER":2377
			</code>
		</pre>

		<b>Creazione della rete comune</b><br>
		Sul Manager:
		<pre>
			<code>
docker network create --driver overlay my-overlay-network
			</code>
		</pre>
		<h3>Deploy</h3>
		Sul nodo manager si lancia il deploy di nome <code style="padding: 0%;">tema-finale</code>:
		<pre>
			<code>
docker stack deploy -c docker-compose-swarm.yml tema-finale
			</code>
		</pre>


		<h2>Test Unit</h2>
		<h3>Test Funzionale GUI</h3>
		<h4>Test 1</h4>
		Nel test funzionale non abbiamo fatto riferimento alla JUnit ma si è preferito utilizzare le tecnologie Web verificando la corretta integrazione della GUI spring con il modello precedentemente sviluppo.  <br>
		<ul>
			<li>Verifichiamo corretta gestione dell'inserimento di un nuovo RP dalla GUI.<br>
				&#x2705; Il test e' superato se i campi della GUI <code style="padding: 0%;">AshStorage</code>, <code style="padding: 0%;">WasteStorage</code>, <code style="padding: 0%;">Incinerator</code>,
				<code style="padding: 0%;">OpRobot_Status</code>, <code style="padding: 0%;">OpRobot_Job</code> hanno registro il corretto processamento dell'RP:
				<ul>
					<li><code style="padding: 0%;">WasteStorage</code> passa da <b>1</b> al valore <b>0</b></li>
					<li><code style="padding: 0%;">AshStorage</code> passa da <b>empty</b> a <b>half</b></li>
					<li><code style="padding: 0%;">Incinerator</code> passa da <b>on</b> a <b>off</b></li>
					<li><code style="padding: 0%;">OpRobot_Status</code> assume i seguenti valori: <b>burnin</b>, <b>home</b>, <b>burnout</b>, <b>ashout</b> e <b>home</b></li>
					<li><code style="padding: 0%;">OpRobot_Job</code> passa da <b>working</b> a <b>idle</b></li>
				</ul>
			</li>
		</ul>

		Al fine di automatizzare il test è stato previsto l'endpoint <code style="padding: 0%;">/test</code>, il quale una volta caricata la pagina, invia automaticamente un RP al sistema WIS e
		dopo un tempo di attesa di 50 secondi verifica i campi precedentemente citati. <br><br><br>


	</div>

	<div style="background-color:rgba(86, 56, 253, 0.9);text-align:left;color:white">
		<div>By Andrea Raffaelli email: andrea.raffaelli2@studio.unibo.it
			<img src="./img/araffaelli.jpg" alt="cyberandrea" width="15%" height="15%">
		</div> <br>
		<div>By Edoardo De Divitiis email: edoardo.dedivitiis@studio.unibo.it
			<img src="./img/edoardoFoto.jpg" alt="mbot" width="15%" height="15%">
		</div> <br>
		<div>By Davide Moricoli email: davide.moricoli@studio.unibo.it
			<img src="./img/davideFoto.jpeg" alt="mbot" width="15%" height="15%">
		</div> <br>
		GIT repo: https://github.com/AndreaRaffaelli/TemaFinale2024_ISS <br>
	</div>
</body>

</html>
